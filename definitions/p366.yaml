id: 366
type: PolicyDefinition
metadata:
  policyName: "AWS:EC2:instance-with-user-data-secrets"
  category: "CSPM"
  stage: "deploy"
  description: "Potential Secret in Instance User Data"
  scheduled_policy: false
  scriptId: 345
  variables: ""
  conditionName: ""
  suggestion: "Remove secrets from EC2 user data immediately and rotate any exposed credentials. Migrate to AWS Secrets Manager or Systems Manager Parameter Store, then update instance configurations to retrieve secrets at runtime using IAM roles."
